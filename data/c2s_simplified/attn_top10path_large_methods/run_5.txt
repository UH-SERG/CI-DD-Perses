
path = /scratch/rabin/data/code2vec/transforms/Methods_Test/java-large/test/apache__apex-core/engine/src/main/java/com/datatorrent/stram/StramLocalCluster_run.java
method_name = run
method_body = @Override @SuppressWarnings({ "SleepWhileInLoop", "ResultOfObjectAllocationIgnored" }) public void run(long runMillis) { Thread eventLoopThread = null; List<Thread> containerThreads = new LinkedList<>(); try { if (!perContainerBufferServer) { eventLoopThread = StreamingContainer.eventloop.start(); bufferServer = new Server(StreamingContainer.eventloop, 0, 1024 * 1024, 8); try { bufferServer.setSpoolStorage(new DiskStorage()); } catch (IOException e) { throw new RuntimeException(e); } bufferServerAddress = InetSocketAddress.createUnresolved(LOCALHOST, bufferServer.run().getPort()); LOG.info("Buffer server started: {}", bufferServerAddress); } long endMillis = System.currentTimeMillis() + runMillis; while (!appDone) { for (String containerIdStr : dnmgr.containerStopRequests.values()) { StreamingContainer c = childContainers.get(containerIdStr); if (c != null) { ContainerHeartbeatResponse r = new ContainerHeartbeatResponse(); r.shutdown = StreamingContainerUmbilicalProtocol.ShutdownType.ABORT; c.processHeartbeatResponse(r); } dnmgr.containerStopRequests.remove(containerIdStr); LOG.info("Container {} restart.", containerIdStr); dnmgr.scheduleContainerRestart(containerIdStr); } while (!dnmgr.containerStartRequests.isEmpty()) { ContainerStartRequest cdr = dnmgr.containerStartRequests.poll(); if (cdr != null) { new LocalStreamingContainerLauncher(cdr, containerThreads); } } if (heartbeatMonitoringEnabled) { dnmgr.monitorHeartbeat(false); } if (childContainers.isEmpty() && dnmgr.containerStartRequests.isEmpty()) { appDone = true; } if (runMillis > 0 && System.currentTimeMillis() > endMillis) { appDone = true; } try { if (exitCondition != null && exitCondition.call()) { LOG.info("Stopping on exit condition"); appDone = true; } } catch (Exception ex) { break; } if (Thread.interrupted()) { break; } if (!appDone) { try { Thread.sleep(1000); } catch (InterruptedException e) { LOG.debug("Sleep interrupted", e); break; } } } } finally { for (LocalStreamingContainer lsc : childContainers.values()) { injectShutdown.put(lsc.getContainerId(), lsc); lsc.triggerHeartbeat(); } for (Thread thread : containerThreads) { try { thread.join(1000); } catch (InterruptedException e) { LOG.debug("Wait for {} to terminate interrupted", thread, e); } if (thread.isAlive()) { LOG.warn("Container thread {} is still alive", thread.getName()); } } try { dnmgr.teardown(); } catch (RuntimeException e) { LOG.warn("Exception during StreamingContainerManager teardown", e); } if (bufferServerAddress != null) { try { bufferServer.stop(); } catch (RuntimeException e) { LOG.warn("Exception during BufferServer stop", e); } } if (eventLoopThread != null) { try { StreamingContainer.eventloop.stop(); eventLoopThread.join(1000); } catch (InterruptedException ie) { LOG.debug("Wait for {} to terminate interrupted", eventLoopThread.getName(), ie); } catch (RuntimeException e) { LOG.warn("Exception during {} stop", StreamingContainer.eventloop, e); } if (StreamingContainer.eventloop.isActive()) { LOG.warn("Event loop {} is still active", StreamingContainer.eventloop); } } } LOG.info("Application finished."); }

topk path-contexts for sub-token: run
[0.0620] e,VariableDeclaratorId0|Parameter|CatchClause|BlockStmt|ExpressionStmt|MethodCallExpr0|StringLiteralExpr2,exception|during|buffer|server|stop
[0.0456] app|done,NameExpr0|UnaryExpr:not|WhileStmt|BlockStmt|TryStmt|CatchClause|Parameter|VariableDeclaratorId0,ex
[0.0414] log,NameExpr0|MethodCallExpr|StringLiteralExpr2,buffer|server|started|{}
[0.0404] wait|for|{}|to|terminate|interrupted,StringLiteralExpr2|MethodCallExpr|ExpressionStmt|BlockStmt|CatchClause|TryStmt|CatchClause|Parameter|VariableDeclaratorId0,e
[0.0376] run|millis,VariableDeclaratorId0|Parameter|MethodDeclaration|BlockStmt|TryStmt|BlockStmt|IfStmt|BinaryExpr:notEquals|NullLiteralExpr1,null
[0.0338] dnmgr,NameExpr0|FieldAccessExpr0|MethodCallExpr|ForeachStmt|BlockStmt|ExpressionStmt|MethodCallExpr0|StringLiteralExpr2,container|{}|restart
[0.0321] log,NameExpr0|MethodCallExpr|StringLiteralExpr2,wait|for|{}|to|terminate|interrupted
[0.0301] interrupted|exception,ClassOrInterfaceType1|Parameter|CatchClause|BlockStmt|ExpressionStmt|MethodCallExpr0|StringLiteralExpr2,sleep|interrupted
[0.0275] log,NameExpr0|MethodCallExpr|StringLiteralExpr2,exception|during|streaming|container|manager|teardown
[0.0275] run|millis,VariableDeclaratorId0|Parameter|MethodDeclaration|BlockStmt|TryStmt|BlockStmt|ForeachStmt|MethodCallExpr1|NameExpr2,values

topk terminals for sub-token: run
['e', 'exception|during|buffer|server|stop', 'app|done', 'ex', 'log', 'buffer|server|started|{}', 'wait|for|{}|to|terminate|interrupted', 'e', 'run|millis', 'null', 'dnmgr', 'container|{}|restart', 'log', 'wait|for|{}|to|terminate|interrupted', 'interrupted|exception', 'sleep|interrupted', 'log', 'exception|during|streaming|container|manager|teardown', 'run|millis', 'values']

